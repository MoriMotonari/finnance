{% extends "main/layout.j2" %}
{% import "main/trans_modal.j2" as trans_modal %}

{% block body %}
<h1 class="display-4">{{ agent.desc }}</h1>

<h2>Transactions</h2>
{% if agent.transactions|length != 0 %}
<table class="table table-hover">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:30%">
    <thead>
        <tr>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th style="text-align: right;" scope="col">Amount</th>
            <th scope="col">Category</th>
            <th scope="col">Comment</th>
            {# <th scope="col"></th> #}
        </tr>
    </thead>
    <tbody>
        {% for trans in agent.transactions %}
        {% if trans.direct_flow_in is none %}
        <tr>
            <td data-sort="{{ trans.date_issued.strftime('%Y%m%d%H%M%s') }}">
            {{ trans.date_issued.strftime('%d.%m.%Y') }}
            </td>
            <td>{{ trans.date_issued.strftime('%H:%M') }}</td>
            <td style="text-align: right;"  
                data-sort="{% if trans.category.is_expense %}{{ trans.amount }}{% else %}{{ -trans.amount }}{% endif %}"
                {% if trans.category.is_expense %}
                    class="text-danger"
                {% else %}
                    class="text-success"
                {% endif %}>
                {{ trans.account.currency.format(trans.amount) }} {{ trans.account.currency.code }}
            </td>
            <td>{{ trans.category.desc }}</td>
            <td>{{ trans.comment }}</td>
            {# <td style="width: 44px; padding: 0px;">
            {% set id = "{acc}-{tr}".format(acc=trans.account.id, tr=trans.id) %}
            <button type="button" class="btn btn-warning btn-lg" style="height: 100%; width: 100%;"
              data-toggle="modal" data-target="#transModal{{ id }}" >
                <i class="fa fa-pencil"></i>
            </button>
            <!-- Modal -->
            <!-- defined in included trans_modals.j2 -->
            {{ trans_modal.modal(trans.account, redirect_url, agents, categories, trans) }}
            </td> #}
        </tr>
        {% endif %}
        
        {% endfor %}
    </tbody>
</table>
{% else %}
No Transactions
{% endif %}


<h2>Flows</h2>
{% if agent.flows|length != 0 %}
<table class="table table-hover">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:auto">
    <col style="width:30%">
    <thead>
        <tr>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th style="text-align: right;" scope="col">Amount</th>
            <th scope="col">Category</th>
            <th scope="col">Comment</th>
            {# <th scope="col"></th> #}
        </tr>
    </thead>
    <tbody>
        {% for flow in agent.flows %}
        {% set trans = flow.trans %}
        <tr>
            <td data-sort="{{ trans.date_issued.strftime('%Y%m%d%H%M%s') }}">
            {{ trans.date_issued.strftime('%d.%m.%Y') }}
            </td>
            <td>{{ trans.date_issued.strftime('%H:%M') }}</td>
            <td style="text-align: right;"  
                data-sort="{% if trans.category.is_expense %}{{ trans.amount }}{% else %}{{ -trans.amount }}{% endif %}"
                {% if trans.category.is_expense %}
                    class="text-danger"
                {% else %}
                    class="text-success"
                {% endif %}>
                {{ trans.account.currency.format(flow.amount) }} {{ trans.account.currency.code }}
            </td>
            <td>{{ trans.category.desc }}</td>
            <td>{{ trans.comment }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
No Flows
{% endif %}


{% endblock body %}